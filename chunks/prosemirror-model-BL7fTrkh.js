import{r as ct}from"./orderedmap-BNSJFzFT.js";var k={},Me;function vt(){if(Me)return k;Me=1;function Re(i,n){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=Ae(i))||n){e&&(i=e);var t=0,r=function(){};return{s:r,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(f){throw f},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){e=e.call(i)},n:function(){var f=e.next();return a=f.done,f},e:function(f){s=!0,o=f},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function Ae(i,n){if(i){if(typeof i=="string")return Q(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Q(i,n)}}function Q(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function I(){return typeof Reflect<"u"&&Reflect.get?I=Reflect.get.bind():I=function(n,e,t){var r=Ie(n,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?n:t):a.value}},I.apply(this,arguments)}function Ie(i,n){for(;!Object.prototype.hasOwnProperty.call(i,n)&&(i=S(i),i!==null););return i}function X(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),n&&N(i,n)}function Y(i){var n=Z();return function(){var t=S(i),r;if(n){var a=S(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return ze(this,r)}}function ze(i,n){if(n&&(w(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fe(i)}function Fe(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function j(i){var n=typeof Map=="function"?new Map:void 0;return j=function(t){if(t===null||!Pe(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return z(t,arguments,S(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),N(r,t)},j(i)}function z(i,n,e){return Z()?z=Reflect.construct.bind():z=function(r,a,s){var o=[null];o.push.apply(o,a);var u=Function.bind.apply(r,o),f=new u;return s&&N(f,s.prototype),f},z.apply(null,arguments)}function Z(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pe(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}function N(i,n){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},N(i,n)}function S(i){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(i)}function w(i){"@babel/helpers - typeof";return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},w(i)}function g(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function $(i,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,De(t.key),t)}}function y(i,n,e){return n&&$(i.prototype,n),e&&$(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function De(i){var n=Je(i,"string");return w(n)==="symbol"?n:String(n)}function Je(i,n){if(w(i)!=="object"||i===null)return i;var e=i[Symbol.toPrimitive];if(e!==void 0){var t=e.call(i,n);if(w(t)!=="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}var ee=ct();function te(i,n,e){for(var t=0;;t++){if(t==i.childCount||t==n.childCount)return i.childCount==n.childCount?null:e;var r=i.child(t),a=n.child(t);if(r==a){e+=r.nodeSize;continue}if(!r.sameMarkup(a))return e;if(r.isText&&r.text!=a.text){for(var s=0;r.text[s]==a.text[s];s++)e++;return e}if(r.content.size||a.content.size){var o=te(r.content,a.content,e+1);if(o!=null)return o}e+=r.nodeSize}}function ne(i,n,e,t){for(var r=i.childCount,a=n.childCount;;){if(r==0||a==0)return r==a?null:{a:e,b:t};var s=i.child(--r),o=n.child(--a),u=s.nodeSize;if(s==o){e-=u,t-=u;continue}if(!s.sameMarkup(o))return{a:e,b:t};if(s.isText&&s.text!=o.text){for(var f=0,h=Math.min(s.text.length,o.text.length);f<h&&s.text[s.text.length-f-1]==o.text[o.text.length-f-1];)f++,e--,t--;return{a:e,b:t}}if(s.content.size||o.content.size){var l=ne(s.content,o.content,e-1,t-1);if(l)return l}e-=u,t-=u}}var m=function(){function i(n,e){if(g(this,i),this.content=n,this.size=e||0,e==null)for(var t=0;t<n.length;t++)this.size+=n[t].nodeSize}return y(i,[{key:"nodesBetween",value:function(e,t,r){for(var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,o=0,u=0;u<t;o++){var f=this.content[o],h=u+f.nodeSize;if(h>e&&r(f,a+u,s||null,o)!==!1&&f.content.size){var l=u+1;f.nodesBetween(Math.max(0,e-l),Math.min(f.content.size,t-l),r,a+l)}u=h}}},{key:"descendants",value:function(e){this.nodesBetween(0,this.size,e)}},{key:"textBetween",value:function(e,t,r,a){var s="",o=!0;return this.nodesBetween(e,t,function(u,f){var h=u.isText?u.text.slice(Math.max(e,f)-f,t-f):u.isLeaf?a?typeof a=="function"?a(u):a:u.type.spec.leafText?u.type.spec.leafText(u):"":"";u.isBlock&&(u.isLeaf&&h||u.isTextblock)&&r&&(o?o=!1:s+=r),s+=h},0),s}},{key:"append",value:function(e){if(!e.size)return this;if(!this.size)return e;var t=this.lastChild,r=e.firstChild,a=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(a[a.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)a.push(e.content[s]);return new i(a,this.size+e.size)}},{key:"cut",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.size;if(e==0&&t==this.size)return this;var r=[],a=0;if(t>e)for(var s=0,o=0;o<t;s++){var u=this.content[s],f=o+u.nodeSize;f>e&&((o<e||f>t)&&(u.isText?u=u.cut(Math.max(0,e-o),Math.min(u.text.length,t-o)):u=u.cut(Math.max(0,e-o-1),Math.min(u.content.size,t-o-1))),r.push(u),a+=u.nodeSize),o=f}return new i(r,a)}},{key:"cutByIndex",value:function(e,t){return e==t?i.empty:e==0&&t==this.content.length?this:new i(this.content.slice(e,t))}},{key:"replaceChild",value:function(e,t){var r=this.content[e];if(r==t)return this;var a=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return a[e]=t,new i(a,s)}},{key:"addToStart",value:function(e){return new i([e].concat(this.content),this.size+e.nodeSize)}},{key:"addToEnd",value:function(e){return new i(this.content.concat(e),this.size+e.nodeSize)}},{key:"eq",value:function(e){if(this.content.length!=e.content.length)return!1;for(var t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}},{key:"firstChild",get:function(){return this.content.length?this.content[0]:null}},{key:"lastChild",get:function(){return this.content.length?this.content[this.content.length-1]:null}},{key:"childCount",get:function(){return this.content.length}},{key:"child",value:function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}},{key:"maybeChild",value:function(e){return this.content[e]||null}},{key:"forEach",value:function(e){for(var t=0,r=0;t<this.content.length;t++){var a=this.content[t];e(a,r,t),r+=a.nodeSize}}},{key:"findDiffStart",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return te(this,e,t)}},{key:"findDiffEnd",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.size,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.size;return ne(this,e,t,r)}},{key:"findIndex",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(e==0)return F(0,e);if(e==this.size)return F(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position ".concat(e," outside of fragment (").concat(this,")"));for(var r=0,a=0;;r++){var s=this.child(r),o=a+s.nodeSize;if(o>=e)return o==e||t>0?F(r+1,o):F(r,a);a=o}}},{key:"toString",value:function(){return"<"+this.toStringInner()+">"}},{key:"toStringInner",value:function(){return this.content.join(", ")}},{key:"toJSON",value:function(){return this.content.length?this.content.map(function(e){return e.toJSON()}):null}}],[{key:"fromJSON",value:function(e,t){if(!t)return i.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new i(t.map(e.nodeFromJSON))}},{key:"fromArray",value:function(e){if(!e.length)return i.empty;for(var t,r=0,a=0;a<e.length;a++){var s=e[a];r+=s.nodeSize,a&&s.isText&&e[a-1].sameMarkup(s)?(t||(t=e.slice(0,a)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new i(t||e,r)}},{key:"from",value:function(e){if(!e)return i.empty;if(e instanceof i)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new i([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}]),i}();m.empty=new m([],0);var U={index:0,offset:0};function F(i,n){return U.index=i,U.offset=n,U}function P(i,n){if(i===n)return!0;if(!(i&&w(i)=="object")||!(n&&w(n)=="object"))return!1;var e=Array.isArray(i);if(Array.isArray(n)!=e)return!1;if(e){if(i.length!=n.length)return!1;for(var t=0;t<i.length;t++)if(!P(i[t],n[t]))return!1}else{for(var r in i)if(!(r in n)||!P(i[r],n[r]))return!1;for(var a in n)if(!(a in i))return!1}return!0}var d=function(){function i(n,e){g(this,i),this.type=n,this.attrs=e}return y(i,[{key:"addToSet",value:function(e){for(var t,r=!1,a=0;a<e.length;a++){var s=e[a];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,a));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,a)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}},{key:"removeFromSet",value:function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}},{key:"isInSet",value:function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}},{key:"eq",value:function(e){return this==e||this.type==e.type&&P(this.attrs,e.attrs)}},{key:"toJSON",value:function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return e}}],[{key:"fromJSON",value:function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var r=e.marks[t.type];if(!r)throw new RangeError("There is no mark type ".concat(t.type," in this schema"));var a=r.create(t.attrs);return r.checkAttrs(a.attrs),a}},{key:"sameSet",value:function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}},{key:"setFrom",value:function(e){if(!e||Array.isArray(e)&&e.length==0)return i.none;if(e instanceof i)return[e];var t=e.slice();return t.sort(function(r,a){return r.type.rank-a.type.rank}),t}}]),i}();d.none=[];var D=function(i){X(e,i);var n=Y(e);function e(){return g(this,e),n.apply(this,arguments)}return y(e)}(j(Error)),T=function(){function i(n,e,t){g(this,i),this.content=n,this.openStart=e,this.openEnd=t}return y(i,[{key:"size",get:function(){return this.content.size-this.openStart-this.openEnd}},{key:"insertAt",value:function(e,t){var r=ie(this.content,e+this.openStart,t);return r&&new i(r,this.openStart,this.openEnd)}},{key:"removeBetween",value:function(e,t){return new i(re(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}},{key:"eq",value:function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}},{key:"toString",value:function(){return this.content+"("+this.openStart+","+this.openEnd+")"}},{key:"toJSON",value:function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}}],[{key:"fromJSON",value:function(e,t){if(!t)return i.empty;var r=t.openStart||0,a=t.openEnd||0;if(typeof r!="number"||typeof a!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new i(m.fromJSON(e,t.content),r,a)}},{key:"maxOpen",value:function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=0,a=0,s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(var o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)a++;return new i(e,r,a)}}]),i}();T.empty=new T(m.empty,0,0);function re(i,n,e){var t=i.findIndex(n),r=t.index,a=t.offset,s=i.maybeChild(r),o=i.findIndex(e),u=o.index,f=o.offset;if(a==n||s.isText){if(f!=e&&!i.child(u).isText)throw new RangeError("Removing non-flat range");return i.cut(0,n).append(i.cut(e))}if(r!=u)throw new RangeError("Removing non-flat range");return i.replaceChild(r,s.copy(re(s.content,n-a-1,e-a-1)))}function ie(i,n,e,t){var r=i.findIndex(n),a=r.index,s=r.offset,o=i.maybeChild(a);if(s==n||o.isText)return i.cut(0,n).append(e).append(i.cut(n));var u=ie(o.content,n-s-1,e);return u&&i.replaceChild(a,o.copy(u))}function qe(i,n,e){if(e.openStart>i.depth)throw new D("Inserted content deeper than insertion position");if(i.depth-e.openStart!=n.depth-e.openEnd)throw new D("Inconsistent open depths");return ae(i,n,e,0)}function ae(i,n,e,t){var r=i.index(t),a=i.node(t);if(r==n.index(t)&&t<i.depth-e.openStart){var s=ae(i,n,e,t+1);return a.copy(a.content.replaceChild(r,s))}else if(e.content.size)if(!e.openStart&&!e.openEnd&&i.depth==t&&n.depth==t){var o=i.parent,u=o.content;return O(o,u.cut(0,i.parentOffset).append(e.content).append(u.cut(n.parentOffset)))}else{var f=Be(e,i),h=f.start,l=f.end;return O(a,oe(i,h,l,n,t))}else return O(a,J(i,n,t))}function se(i,n){if(!n.type.compatibleContent(i.type))throw new D("Cannot join "+n.type.name+" onto "+i.type.name)}function V(i,n,e){var t=i.node(e);return se(t,n.node(e)),t}function b(i,n){var e=n.length-1;e>=0&&i.isText&&i.sameMarkup(n[e])?n[e]=i.withText(n[e].text+i.text):n.push(i)}function M(i,n,e,t){var r=(n||i).node(e),a=0,s=n?n.index(e):r.childCount;i&&(a=i.index(e),i.depth>e?a++:i.textOffset&&(b(i.nodeAfter,t),a++));for(var o=a;o<s;o++)b(r.child(o),t);n&&n.depth==e&&n.textOffset&&b(n.nodeBefore,t)}function O(i,n){return i.type.checkContent(n),i.copy(n)}function oe(i,n,e,t,r){var a=i.depth>r&&V(i,n,r+1),s=t.depth>r&&V(e,t,r+1),o=[];return M(null,i,r,o),a&&s&&n.index(r)==e.index(r)?(se(a,s),b(O(a,oe(i,n,e,t,r+1)),o)):(a&&b(O(a,J(i,n,r+1)),o),M(n,e,r,o),s&&b(O(s,J(e,t,r+1)),o)),M(t,null,r,o),new m(o)}function J(i,n,e){var t=[];if(M(null,i,e,t),i.depth>e){var r=V(i,n,e+1);b(O(r,J(i,n,e+1)),t)}return M(n,null,e,t),new m(t)}function Be(i,n){for(var e=n.depth-i.openStart,t=n.node(e),r=t.copy(i.content),a=e-1;a>=0;a--)r=n.node(a).copy(m.from(r));return{start:r.resolveNoCache(i.openStart+e),end:r.resolveNoCache(r.content.size-i.openEnd-e)}}var G=function(){function i(n,e,t){g(this,i),this.pos=n,this.path=e,this.parentOffset=t,this.depth=e.length/3-1}return y(i,[{key:"resolveDepth",value:function(e){return e==null?this.depth:e<0?this.depth+e:e}},{key:"parent",get:function(){return this.node(this.depth)}},{key:"doc",get:function(){return this.node(0)}},{key:"node",value:function(e){return this.path[this.resolveDepth(e)*3]}},{key:"index",value:function(e){return this.path[this.resolveDepth(e)*3+1]}},{key:"indexAfter",value:function(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}},{key:"start",value:function(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}},{key:"end",value:function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}},{key:"before",value:function(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}},{key:"after",value:function(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}},{key:"textOffset",get:function(){return this.pos-this.path[this.path.length-1]}},{key:"nodeAfter",get:function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var r=this.pos-this.path[this.path.length-1],a=e.child(t);return r?e.child(t).cut(r):a}},{key:"nodeBefore",get:function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}},{key:"posAtIndex",value:function(e,t){t=this.resolveDepth(t);for(var r=this.path[t*3],a=t==0?0:this.path[t*3-1]+1,s=0;s<e;s++)a+=r.child(s).nodeSize;return a}},{key:"marks",value:function(){var e=this.parent,t=this.index();if(e.content.size==0)return d.none;if(this.textOffset)return e.child(t).marks;var r=e.maybeChild(t-1),a=e.maybeChild(t);if(!r){var s=r;r=a,a=s}for(var o=r.marks,u=0;u<o.length;u++)o[u].type.spec.inclusive===!1&&(!a||!o[u].isInSet(a.marks))&&(o=o[u--].removeFromSet(o));return o}},{key:"marksAcross",value:function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var r=t.marks,a=e.parent.maybeChild(e.index()),s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!a||!r[s].isInSet(a.marks))&&(r=r[s--].removeFromSet(r));return r}},{key:"sharedDepth",value:function(e){for(var t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}},{key:"blockRange",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,t=arguments.length>1?arguments[1]:void 0;if(e.pos<this.pos)return e.blockRange(this);for(var r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new fe(this,e,r);return null}},{key:"sameParent",value:function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}},{key:"max",value:function(e){return e.pos>this.pos?e:this}},{key:"min",value:function(e){return e.pos<this.pos?e:this}},{key:"toString",value:function(){for(var e="",t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}}],[{key:"resolve",value:function(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");for(var r=[],a=0,s=t,o=e;;){var u=o.content.findIndex(s),f=u.index,h=u.offset,l=s-h;if(r.push(o,f,a+h),!l||(o=o.child(f),o.isText))break;s=l-1,a+=h+1}return new i(t,r,s)}},{key:"resolveCached",value:function(e,t){var r=ue.get(e);if(r)for(var a=0;a<r.elts.length;a++){var s=r.elts[a];if(s.pos==t)return s}else ue.set(e,r=new Le);var o=r.elts[r.i]=i.resolve(e,t);return r.i=(r.i+1)%We,o}}]),i}(),Le=y(function i(){g(this,i),this.elts=[],this.i=0}),We=12,ue=new WeakMap,fe=function(){function i(n,e,t){g(this,i),this.$from=n,this.$to=e,this.depth=t}return y(i,[{key:"start",get:function(){return this.$from.before(this.depth+1)}},{key:"end",get:function(){return this.$to.after(this.depth+1)}},{key:"parent",get:function(){return this.$from.node(this.depth)}},{key:"startIndex",get:function(){return this.$from.index(this.depth)}},{key:"endIndex",get:function(){return this.$to.indexAfter(this.depth)}}]),i}(),_e=Object.create(null),E=function(){function i(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:d.none;g(this,i),this.type=n,this.attrs=e,this.marks=r,this.content=t||m.empty}return y(i,[{key:"nodeSize",get:function(){return this.isLeaf?1:2+this.content.size}},{key:"childCount",get:function(){return this.content.childCount}},{key:"child",value:function(e){return this.content.child(e)}},{key:"maybeChild",value:function(e){return this.content.maybeChild(e)}},{key:"forEach",value:function(e){this.content.forEach(e)}},{key:"nodesBetween",value:function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;this.content.nodesBetween(e,t,r,a,this)}},{key:"descendants",value:function(e){this.nodesBetween(0,this.content.size,e)}},{key:"textContent",get:function(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}},{key:"textBetween",value:function(e,t,r,a){return this.content.textBetween(e,t,r,a)}},{key:"firstChild",get:function(){return this.content.firstChild}},{key:"lastChild",get:function(){return this.content.lastChild}},{key:"eq",value:function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}},{key:"sameMarkup",value:function(e){return this.hasMarkup(e.type,e.attrs,e.marks)}},{key:"hasMarkup",value:function(e,t,r){return this.type==e&&P(this.attrs,t||e.defaultAttrs||_e)&&d.sameSet(this.marks,r||d.none)}},{key:"copy",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e==this.content?this:new i(this.type,this.attrs,e,this.marks)}},{key:"mark",value:function(e){return e==this.marks?this:new i(this.type,this.attrs,this.content,e)}},{key:"cut",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.content.size;return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}},{key:"slice",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.content.size,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e==t)return T.empty;var a=this.resolve(e),s=this.resolve(t),o=r?0:a.sharedDepth(t),u=a.start(o),f=a.node(o),h=f.content.cut(a.pos-u,s.pos-u);return new T(h,a.depth-o,s.depth-o)}},{key:"replace",value:function(e,t,r){return qe(this.resolve(e),this.resolve(t),r)}},{key:"nodeAt",value:function(e){for(var t=this;;){var r=t.content.findIndex(e),a=r.index,s=r.offset;if(t=t.maybeChild(a),!t)return null;if(s==e||t.isText)return t;e-=s+1}}},{key:"childAfter",value:function(e){var t=this.content.findIndex(e),r=t.index,a=t.offset;return{node:this.content.maybeChild(r),index:r,offset:a}}},{key:"childBefore",value:function(e){if(e==0)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),r=t.index,a=t.offset;if(a<e)return{node:this.content.child(r),index:r,offset:a};var s=this.content.child(r-1);return{node:s,index:r-1,offset:a-s.nodeSize}}},{key:"resolve",value:function(e){return G.resolveCached(this,e)}},{key:"resolveNoCache",value:function(e){return G.resolve(this,e)}},{key:"rangeHasMark",value:function(e,t,r){var a=!1;return t>e&&this.nodesBetween(e,t,function(s){return r.isInSet(s.marks)&&(a=!0),!a}),a}},{key:"isBlock",get:function(){return this.type.isBlock}},{key:"isTextblock",get:function(){return this.type.isTextblock}},{key:"inlineContent",get:function(){return this.type.inlineContent}},{key:"isInline",get:function(){return this.type.isInline}},{key:"isText",get:function(){return this.type.isText}},{key:"isLeaf",get:function(){return this.type.isLeaf}},{key:"isAtom",get:function(){return this.type.isAtom}},{key:"toString",value:function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),he(this.marks,e)}},{key:"contentMatchAt",value:function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}},{key:"canReplace",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m.empty,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:r.childCount,o=this.contentMatchAt(e).matchFragment(r,a,s),u=o&&o.matchFragment(this.content,t);if(!u||!u.validEnd)return!1;for(var f=a;f<s;f++)if(!this.type.allowsMarks(r.child(f).marks))return!1;return!0}},{key:"canReplaceWith",value:function(e,t,r,a){if(a&&!this.type.allowsMarks(a))return!1;var s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,t);return o?o.validEnd:!1}},{key:"canAppend",value:function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}},{key:"check",value:function(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);for(var e=d.none,t=0;t<this.marks.length;t++){var r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!d.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map(function(a){return a.type.name})));this.content.forEach(function(a){return a.check()})}},{key:"toJSON",value:function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(function(r){return r.toJSON()})),e}}],[{key:"fromJSON",value:function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var r=void 0;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}var a=m.fromJSON(e,t.content),s=e.nodeType(t.type).create(t.attrs,a,r);return s.type.checkAttrs(s.attrs),s}}]),i}();E.prototype.text=void 0;var je=function(i){X(e,i);var n=Y(e);function e(t,r,a,s){var o;if(g(this,e),o=n.call(this,t,r,null,s),!a)throw new RangeError("Empty text nodes are not allowed");return o.text=a,o}return y(e,[{key:"toString",value:function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):he(this.marks,JSON.stringify(this.text))}},{key:"textContent",get:function(){return this.text}},{key:"textBetween",value:function(r,a){return this.text.slice(r,a)}},{key:"nodeSize",get:function(){return this.text.length}},{key:"mark",value:function(r){return r==this.marks?this:new e(this.type,this.attrs,this.text,r)}},{key:"withText",value:function(r){return r==this.text?this:new e(this.type,this.attrs,r,this.marks)}},{key:"cut",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.text.length;return r==0&&a==this.text.length?this:this.withText(this.text.slice(r,a))}},{key:"eq",value:function(r){return this.sameMarkup(r)&&this.text==r.text}},{key:"toJSON",value:function(){var r=I(S(e.prototype),"toJSON",this).call(this);return r.text=this.text,r}}]),e}(E);function he(i,n){for(var e=i.length-1;e>=0;e--)n=i[e].type.name+"("+n+")";return n}var C=function(){function i(n){g(this,i),this.validEnd=n,this.next=[],this.wrapCache=[]}return y(i,[{key:"matchType",value:function(e){for(var t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}},{key:"matchFragment",value:function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.childCount,a=this,s=t;a&&s<r;s++)a=a.matchType(e.child(s).type);return a}},{key:"inlineContent",get:function(){return this.next.length!=0&&this.next[0].type.isInline}},{key:"defaultType",get:function(){for(var e=0;e<this.next.length;e++){var t=this.next[e].type;if(!(t.isText||t.hasRequiredAttrs()))return t}return null}},{key:"compatible",value:function(e){for(var t=0;t<this.next.length;t++)for(var r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}},{key:"fillBefore",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=[this];function s(o,u){var f=o.matchFragment(e,r);if(f&&(!t||f.validEnd))return m.from(u.map(function(x){return x.createAndFill()}));for(var h=0;h<o.next.length;h++){var l=o.next[h],c=l.type,v=l.next;if(!(c.isText||c.hasRequiredAttrs())&&a.indexOf(v)==-1){a.push(v);var p=s(v,u.concat(c));if(p)return p}}return null}return s(this,[])}},{key:"findWrapping",value:function(e){for(var t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];var r=this.computeWrapping(e);return this.wrapCache.push(e,r),r}},{key:"computeWrapping",value:function(e){for(var t=Object.create(null),r=[{match:this,type:null,via:null}];r.length;){var a=r.shift(),s=a.match;if(s.matchType(e)){for(var o=[],u=a;u.type;u=u.via)o.push(u.type);return o.reverse()}for(var f=0;f<s.next.length;f++){var h=s.next[f],l=h.type,c=h.next;!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!a.type||c.validEnd)&&(r.push({match:l.contentMatch,type:l,via:a}),t[l.name]=!0)}}return null}},{key:"edgeCount",get:function(){return this.next.length}},{key:"edge",value:function(e){if(e>=this.next.length)throw new RangeError("There's no ".concat(e,"th edge in this content match"));return this.next[e]}},{key:"toString",value:function(){var e=[];function t(r){e.push(r);for(var a=0;a<r.next.length;a++)e.indexOf(r.next[a].next)==-1&&t(r.next[a].next)}return t(this),e.map(function(r,a){for(var s=a+(r.validEnd?"*":" ")+" ",o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}],[{key:"parse",value:function(e,t){var r=new Ue(e,t);if(r.next==null)return i.empty;var a=le(r);r.next&&r.err("Unexpected trailing text");var s=Ye(Xe(a));return Ze(s,r),s}}]),i}();C.empty=new C(!0);var Ue=function(){function i(n,e){g(this,i),this.string=n,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=n.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}return y(i,[{key:"next",get:function(){return this.tokens[this.pos]}},{key:"eat",value:function(e){return this.next==e&&(this.pos++||!0)}},{key:"err",value:function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}]),i}();function le(i){var n=[];do n.push(Ve(i));while(i.eat("|"));return n.length==1?n[0]:{type:"choice",exprs:n}}function Ve(i){var n=[];do n.push(Ge(i));while(i.next&&i.next!=")"&&i.next!="|");return n.length==1?n[0]:{type:"seq",exprs:n}}function Ge(i){for(var n=Qe(i);;)if(i.eat("+"))n={type:"plus",expr:n};else if(i.eat("*"))n={type:"star",expr:n};else if(i.eat("?"))n={type:"opt",expr:n};else if(i.eat("{"))n=He(i,n);else break;return n}function ce(i){/\D/.test(i.next)&&i.err("Expected number, got '"+i.next+"'");var n=Number(i.next);return i.pos++,n}function He(i,n){var e=ce(i),t=e;return i.eat(",")&&(i.next!="}"?t=ce(i):t=-1),i.eat("}")||i.err("Unclosed braced range"),{type:"range",min:e,max:t,expr:n}}function Ke(i,n){var e=i.nodeTypes,t=e[n];if(t)return[t];var r=[];for(var a in e){var s=e[a];s.isInGroup(n)&&r.push(s)}return r.length==0&&i.err("No node type or group '"+n+"' found"),r}function Qe(i){if(i.eat("(")){var n=le(i);return i.eat(")")||i.err("Missing closing paren"),n}else if(/\W/.test(i.next))i.err("Unexpected token '"+i.next+"'");else{var e=Ke(i,i.next).map(function(t){return i.inline==null?i.inline=t.isInline:i.inline!=t.isInline&&i.err("Mixing inline and block content"),{type:"name",value:t}});return i.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Xe(i){var n=[[]];return r(a(i,0),e()),n;function e(){return n.push([])-1}function t(s,o,u){var f={term:u,to:o};return n[s].push(f),f}function r(s,o){s.forEach(function(u){return u.to=o})}function a(s,o){if(s.type=="choice")return s.exprs.reduce(function(_,lt){return _.concat(a(lt,o))},[]);if(s.type=="seq")for(var u=0;;u++){var f=a(s.exprs[u],o);if(u==s.exprs.length-1)return f;r(f,o=e())}else if(s.type=="star"){var h=e();return t(o,h),r(a(s.expr,h),h),[t(h)]}else if(s.type=="plus"){var l=e();return r(a(s.expr,o),l),r(a(s.expr,l),l),[t(l)]}else{if(s.type=="opt")return[t(o)].concat(a(s.expr,o));if(s.type=="range"){for(var c=o,v=0;v<s.min;v++){var p=e();r(a(s.expr,c),p),c=p}if(s.max==-1)r(a(s.expr,c),c);else for(var x=s.min;x<s.max;x++){var A=e();t(c,A),r(a(s.expr,c),A),c=A}return[t(c)]}else{if(s.type=="name")return[t(o,void 0,s.value)];throw new Error("Unknown expr type")}}}}function ve(i,n){return n-i}function de(i,n){var e=[];return t(n),e.sort(ve);function t(r){var a=i[r];if(a.length==1&&!a[0].term)return t(a[0].to);e.push(r);for(var s=0;s<a.length;s++){var o=a[s],u=o.term,f=o.to;!u&&e.indexOf(f)==-1&&t(f)}}}function Ye(i){var n=Object.create(null);return e(de(i,0));function e(t){var r=[];t.forEach(function(u){i[u].forEach(function(f){var h=f.term,l=f.to;if(h){for(var c,v=0;v<r.length;v++)r[v][0]==h&&(c=r[v][1]);de(i,l).forEach(function(p){c||r.push([h,c=[]]),c.indexOf(p)==-1&&c.push(p)})}})});for(var a=n[t.join(",")]=new C(t.indexOf(i.length-1)>-1),s=0;s<r.length;s++){var o=r[s][1].sort(ve);a.next.push({type:r[s][0],next:n[o.join(",")]||e(o)})}return a}}function Ze(i,n){for(var e=0,t=[i];e<t.length;e++){for(var r=t[e],a=!r.validEnd,s=[],o=0;o<r.next.length;o++){var u=r.next[o],f=u.type,h=u.next;s.push(f.name),a&&!(f.isText||f.hasRequiredAttrs())&&(a=!1),t.indexOf(h)==-1&&t.push(h)}a&&n.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function pe(i){var n=Object.create(null);for(var e in i){var t=i[e];if(!t.hasDefault)return null;n[e]=t.default}return n}function ge(i,n){var e=Object.create(null);for(var t in i){var r=n&&n[t];if(r===void 0){var a=i[t];if(a.hasDefault)r=a.default;else throw new RangeError("No value supplied for attribute "+t)}e[t]=r}return e}function ye(i,n,e,t){for(var r in n)if(!(r in i))throw new RangeError("Unsupported attribute ".concat(r," for ").concat(e," of type ").concat(r));for(var a in i){var s=i[a];s.validate&&s.validate(n[a])}}function me(i,n){var e=Object.create(null);if(n)for(var t in n)e[t]=new et(i,t,n[t]);return e}var H=function(){function i(n,e,t){g(this,i),this.name=n,this.schema=e,this.spec=t,this.markSet=null,this.groups=t.group?t.group.split(" "):[],this.attrs=me(n,t.attrs),this.defaultAttrs=pe(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(t.inline||n=="text"),this.isText=n=="text"}return y(i,[{key:"isInline",get:function(){return!this.isBlock}},{key:"isTextblock",get:function(){return this.isBlock&&this.inlineContent}},{key:"isLeaf",get:function(){return this.contentMatch==C.empty}},{key:"isAtom",get:function(){return this.isLeaf||!!this.spec.atom}},{key:"isInGroup",value:function(e){return this.groups.indexOf(e)>-1}},{key:"whitespace",get:function(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}},{key:"hasRequiredAttrs",value:function(){for(var e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}},{key:"compatibleContent",value:function(e){return this==e||this.contentMatch.compatible(e.contentMatch)}},{key:"computeAttrs",value:function(e){return!e&&this.defaultAttrs?this.defaultAttrs:ge(this.attrs,e)}},{key:"create",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new E(this,this.computeAttrs(e),m.from(t),d.setFrom(r))}},{key:"createChecked",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return t=m.from(t),this.checkContent(t),new E(this,this.computeAttrs(e),t,d.setFrom(r))}},{key:"createAndFill",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;if(e=this.computeAttrs(e),t=m.from(t),t.size){var a=this.contentMatch.fillBefore(t);if(!a)return null;t=a.append(t)}var s=this.contentMatch.matchFragment(t),o=s&&s.fillBefore(m.empty,!0);return o?new E(this,e,t.append(o),d.setFrom(r)):null}},{key:"validContent",value:function(e){var t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(var r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}},{key:"checkContent",value:function(e){if(!this.validContent(e))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(e.toString().slice(0,50)))}},{key:"checkAttrs",value:function(e){ye(this.attrs,e,"node",this.name)}},{key:"allowsMarkType",value:function(e){return this.markSet==null||this.markSet.indexOf(e)>-1}},{key:"allowsMarks",value:function(e){if(this.markSet==null)return!0;for(var t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}},{key:"allowedMarks",value:function(e){if(this.markSet==null)return e;for(var t,r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:d.none:e}}],[{key:"compile",value:function(e,t){var r=Object.create(null);e.forEach(function(o,u){return r[o]=new i(o,t,u)});var a=t.spec.topNode||"doc";if(!r[a])throw new RangeError("Schema is missing its top node type ('"+a+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(var s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}]),i}();function $e(i,n,e){var t=e.split("|");return function(r){var a=r===null?"null":w(r);if(t.indexOf(a)<0)throw new RangeError("Expected value of type ".concat(t," for attribute ").concat(n," on type ").concat(i,", got ").concat(a))}}var et=function(){function i(n,e,t){g(this,i),this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default,this.validate=typeof t.validate=="string"?$e(n,e,t.validate):t.validate}return y(i,[{key:"isRequired",get:function(){return!this.hasDefault}}]),i}(),ke=function(){function i(n,e,t,r){g(this,i),this.name=n,this.rank=e,this.schema=t,this.spec=r,this.attrs=me(n,r.attrs),this.excluded=null;var a=pe(this.attrs);this.instance=a?new d(this,a):null}return y(i,[{key:"create",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return!e&&this.instance?this.instance:new d(this,ge(this.attrs,e))}},{key:"removeFromSet",value:function(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}},{key:"isInSet",value:function(e){for(var t=0;t<e.length;t++)if(e[t].type==this)return e[t]}},{key:"checkAttrs",value:function(e){ye(this.attrs,e,"mark",this.name)}},{key:"excludes",value:function(e){return this.excluded.indexOf(e)>-1}}],[{key:"compile",value:function(e,t){var r=Object.create(null),a=0;return e.forEach(function(s,o){return r[s]=new i(s,a++,t,o)}),r}}]),i}(),tt=function(){function i(n){g(this,i),this.linebreakReplacement=null,this.cached=Object.create(null);var e=this.spec={};for(var t in n)e[t]=n[t];e.nodes=ee.from(n.nodes),e.marks=ee.from(n.marks||{}),this.nodes=H.compile(this.spec.nodes,this),this.marks=ke.compile(this.spec.marks,this);var r=Object.create(null);for(var a in this.nodes){if(a in this.marks)throw new RangeError(a+" can not be both a node and a mark");var s=this.nodes[a],o=s.spec.content||"",u=s.spec.marks;if(s.contentMatch=r[o]||(r[o]=C.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=u=="_"?null:u?xe(this,u.split(" ")):u==""||!s.inlineContent?[]:null}for(var f in this.marks){var h=this.marks[f],l=h.spec.excludes;h.excluded=l==null?[h]:l==""?[]:xe(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}return y(i,[{key:"node",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(typeof e=="string")e=this.nodeType(e);else if(e instanceof H){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,a)}},{key:"text",value:function(e,t){var r=this.nodes.text;return new je(r,r.defaultAttrs,e,d.setFrom(t))}},{key:"mark",value:function(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}},{key:"nodeFromJSON",value:function(e){return E.fromJSON(this,e)}},{key:"markFromJSON",value:function(e){return d.fromJSON(this,e)}},{key:"nodeType",value:function(e){var t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}]),i}();function xe(i,n){for(var e=[],t=0;t<n.length;t++){var r=n[t],a=i.marks[r],s=a;if(a)e.push(a);else for(var o in i.marks){var u=i.marks[o];(r=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(r)>-1)&&e.push(s=u)}if(!s)throw new SyntaxError("Unknown mark type: '"+n[t]+"'")}return e}function nt(i){return i.tag!=null}function rt(i){return i.style!=null}var it=function(){function i(n,e){var t=this;g(this,i),this.schema=n,this.rules=e,this.tags=[],this.styles=[];var r=this.matchedStyles=[];e.forEach(function(a){if(nt(a))t.tags.push(a);else if(rt(a)){var s=/[^=]*/.exec(a.style)[0];r.indexOf(s)<0&&r.push(s),t.styles.push(a)}}),this.normalizeLists=!this.tags.some(function(a){if(!/^(ul|ol)\b/.test(a.tag)||!a.node)return!1;var s=n.nodes[a.node];return s.contentMatch.matchType(s)})}return y(i,[{key:"parse",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=new Oe(this,t,!1);return r.addAll(e,d.none,t.from,t.to),r.finish()}},{key:"parseSlice",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=new Oe(this,t,!0);return r.addAll(e,d.none,t.from,t.to),T.maxOpen(r.finish())}},{key:"matchTag",value:function(e,t,r){for(var a=r?this.tags.indexOf(r)+1:0;a<this.tags.length;a++){var s=this.tags[a];if(ot(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){var o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}},{key:"matchStyle",value:function(e,t,r,a){for(var s=a?this.styles.indexOf(a)+1:0;s<this.styles.length;s++){var o=this.styles[s],u=o.style;if(!(u.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||u.length>e.length&&(u.charCodeAt(e.length)!=61||u.slice(e.length+1)!=t))){if(o.getAttrs){var f=o.getAttrs(t);if(f===!1)continue;o.attrs=f||void 0}return o}}}}],[{key:"schemaRules",value:function(e){var t=[];function r(f){for(var h=f.priority==null?50:f.priority,l=0;l<t.length;l++){var c=t[l],v=c.priority==null?50:c.priority;if(v<h)break}t.splice(l,0,f)}var a=function(h){var l=e.marks[h].spec.parseDOM;l&&l.forEach(function(c){r(c=Ee(c)),c.mark||c.ignore||c.clearMark||(c.mark=h)})};for(var s in e.marks)a(s);var o=function(h){var l=e.nodes[h].spec.parseDOM;l&&l.forEach(function(c){r(c=Ee(c)),c.node||c.ignore||c.mark||(c.node=h)})};for(var u in e.nodes)o(u);return t}},{key:"fromSchema",value:function(e){return e.cached.domParser||(e.cached.domParser=new i(e,i.schemaRules(e)))}}]),i}(),we={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},at={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Se={ol:!0,ul:!0},q=1,B=2,R=4;function be(i,n,e){return n!=null?(n?q:0)|(n==="full"?B:0):i&&i.whitespace=="pre"?q|B:e&~R}var L=function(){function i(n,e,t,r,a,s){g(this,i),this.type=n,this.attrs=e,this.marks=t,this.solid=r,this.options=s,this.content=[],this.activeMarks=d.none,this.match=a||(s&R?null:n.contentMatch)}return y(i,[{key:"findWrapping",value:function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(m.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{var r=this.type.contentMatch,a;return(a=r.findWrapping(e.type))?(this.match=r,a):null}}return this.match.findWrapping(e.type)}},{key:"finish",value:function(e){if(!(this.options&q)){var t=this.content[this.content.length-1],r;if(t&&t.isText&&(r=/[ \t\r\n\u000c]+$/.exec(t.text))){var a=t;t.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-r[0].length))}}var s=m.from(this.content);return!e&&this.match&&(s=s.append(this.match.fillBefore(m.empty,!0))),this.type?this.type.create(this.attrs,s,this.marks):s}},{key:"inlineContext",value:function(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!we.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}]),i}(),Oe=function(){function i(n,e,t){g(this,i),this.parser=n,this.options=e,this.isOpen=t,this.open=0;var r=e.topNode,a,s=be(null,e.preserveWhitespace,0)|(t?R:0);r?a=new L(r.type,r.attrs,d.none,!0,e.topMatch||r.type.contentMatch,s):t?a=new L(null,null,d.none,!0,null,s):a=new L(n.schema.topNodeType,null,d.none,!0,null,s),this.nodes=[a],this.find=e.findPositions,this.needsBlock=!1}return y(i,[{key:"top",get:function(){return this.nodes[this.open]}},{key:"addDOM",value:function(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}},{key:"addTextNode",value:function(e,t){var r=e.nodeValue,a=this.top;if(a.options&B||a.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(a.options&q)a.options&B?r=r.replace(/\r\n?/g,`
`):r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){var s=a.content[a.content.length-1],o=e.previousSibling;(!s||o&&o.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t),this.findInText(e)}else this.findInside(e)}},{key:"addElement",value:function(e,t,r){var a=e.nodeName.toLowerCase(),s;Se.hasOwnProperty(a)&&this.parser.normalizeLists&&st(e);var o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,r));if(o?o.ignore:at.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);var u,f=this.top,h=this.needsBlock;if(we.hasOwnProperty(a))f.content.length&&f.content[0].isInline&&this.open&&(this.open--,f=this.top),u=!0,f.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);return}var l=o&&o.skip?t:this.readStyles(e,t);l&&this.addAll(e,l),u&&this.sync(f),this.needsBlock=h}else{var c=this.readStyles(e,t);c&&this.addElementByRule(e,o,c,o.consuming===!1?s:void 0)}}},{key:"leafFallback",value:function(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}},{key:"ignoreFallback",value:function(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t)}},{key:"readStyles",value:function(e,t){var r=this,a=e.style;if(a&&a.length)for(var s=0;s<this.parser.matchedStyles.length;s++){var o=this.parser.matchedStyles[s],u=a.getPropertyValue(o);if(u){for(var f=function(v){var p=r.parser.matchStyle(o,u,r,v);if(!p)return l=v,0;if(p.ignore)return{v:null};if(p.clearMark?t=t.filter(function(x){return!p.clearMark(x)}):t=t.concat(r.parser.schema.marks[p.mark].create(p.attrs)),p.consuming===!1)v=p;else return l=v,0;l=v},h,l=void 0;h=f(l),h!==0;)if(h)return h.v}}return t}},{key:"addElementByRule",value:function(e,t,r,a){var s=this,o,u;if(t.node)if(u=this.parser.schema.nodes[t.node],u.isLeaf)this.insertNode(u.create(t.attrs),r)||this.leafFallback(e,r);else{var f=this.enter(u,t.attrs||null,r,t.preserveWhitespace);f&&(o=!0,r=f)}else{var h=this.parser.schema.marks[t.mark];r=r.concat(h.create(t.attrs))}var l=this.top;if(u&&u.isLeaf)this.findInside(e);else if(a)this.addElement(e,r,a);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(function(v){return s.insertNode(v,r)});else{var c=e;typeof t.contentElement=="string"?c=e.querySelector(t.contentElement):typeof t.contentElement=="function"?c=t.contentElement(e):t.contentElement&&(c=t.contentElement),this.findAround(e,c,!0),this.addAll(c,r),this.findAround(e,c,!1)}o&&this.sync(l)&&this.open--}},{key:"addAll",value:function(e,t,r,a){for(var s=r||0,o=r?e.childNodes[r]:e.firstChild,u=a==null?null:e.childNodes[a];o!=u;o=o.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(o,t);this.findAtPoint(e,s)}},{key:"findPlace",value:function(e,t){for(var r,a,s=this.open;s>=0;s--){var o=this.nodes[s],u=o.findWrapping(e);if(u&&(!r||r.length>u.length)&&(r=u,a=o,!u.length)||o.solid)break}if(!r)return null;this.sync(a);for(var f=0;f<r.length;f++)t=this.enterInner(r[f],null,t,!1);return t}},{key:"insertNode",value:function(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){var r=this.textblockFromContext();r&&(t=this.enterInner(r,null,t))}var a=this.findPlace(e,t);if(a){this.closeExtra();var s=this.top;s.match&&(s.match=s.match.matchType(e.type));var o=d.none,u=Re(a.concat(e.marks)),f;try{for(u.s();!(f=u.n()).done;){var h=f.value;(s.type?s.type.allowsMarkType(h.type):Te(h.type,e.type))&&(o=h.addToSet(o))}}catch(l){u.e(l)}finally{u.f()}return s.content.push(e.mark(o)),!0}return!1}},{key:"enter",value:function(e,t,r,a){var s=this.findPlace(e.create(t),r);return s&&(s=this.enterInner(e,t,r,!0,a)),s}},{key:"enterInner",value:function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;this.closeExtra();var o=this.top;o.match=o.match&&o.match.matchType(e);var u=be(e,s,o.options);o.options&R&&o.content.length==0&&(u|=R);var f=d.none;return r=r.filter(function(h){return(o.type?o.type.allowsMarkType(h.type):Te(h.type,e))?(f=h.addToSet(f),!1):!0}),this.nodes.push(new L(e,t,f,a,null,u)),this.open++,r}},{key:"closeExtra",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}},{key:"finish",value:function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}},{key:"sync",value:function(e){for(var t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}},{key:"currentPos",get:function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var r=this.nodes[t].content,a=r.length-1;a>=0;a--)e+=r[a].nodeSize;t&&e++}return e}},{key:"findAtPoint",value:function(e,t){if(this.find)for(var r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}},{key:"findInside",value:function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}},{key:"findAround",value:function(e,t,r){if(e!=t&&this.find){for(var a=0;a<this.find.length;a++)if(this.find[a].pos==null&&e.nodeType==1&&e.contains(this.find[a].node)){var s=t.compareDocumentPosition(this.find[a].node);s&(r?2:4)&&(this.find[a].pos=this.currentPos)}}}},{key:"findInText",value:function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}},{key:"matchesContext",value:function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var r=e.split("/"),a=this.options.context,s=!this.isOpen&&(!a||a.parent.type==this.nodes[0].type),o=-(a?a.depth+1:0)+(s?0:1),u=function f(h,l){for(;h>=0;h--){var c=r[h];if(c==""){if(h==r.length-1||h==0)continue;for(;l>=o;l--)if(f(h-1,l))return!0;return!1}else{var v=l>0||l==0&&s?t.nodes[l].type:a&&l>=o?a.node(l-o).type:null;if(!v||v.name!=c&&!v.isInGroup(c))return!1;l--}}return!0};return u(r.length-1,this.open)}},{key:"textblockFromContext",value:function(){var e=this.options.context;if(e)for(var t=e.depth;t>=0;t--){var r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(var a in this.parser.schema.nodes){var s=this.parser.schema.nodes[a];if(s.isTextblock&&s.defaultAttrs)return s}}}]),i}();function st(i){for(var n=i.firstChild,e=null;n;n=n.nextSibling){var t=n.nodeType==1?n.nodeName.toLowerCase():null;t&&Se.hasOwnProperty(t)&&e?(e.appendChild(n),n=e):t=="li"?e=n:t&&(e=null)}}function ot(i,n){return(i.matches||i.msMatchesSelector||i.webkitMatchesSelector||i.mozMatchesSelector).call(i,n)}function Ee(i){var n={};for(var e in i)n[e]=i[e];return n}function Te(i,n){var e=n.schema.nodes,t=function(){var o=e[a];if(!o.allowsMarkType(i))return 0;var u=[],f=function h(l){u.push(l);for(var c=0;c<l.edgeCount;c++){var v=l.edge(c),p=v.type,x=v.next;if(p==n||u.indexOf(x)<0&&h(x))return!0}};if(f(o.contentMatch))return{v:!0}},r;for(var a in e)if(r=t(),r!==0&&r)return r.v}var ut=function(){function i(n,e){g(this,i),this.nodes=n,this.marks=e}return y(i,[{key:"serializeFragment",value:function(e){var t=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;a||(a=K(r).createDocumentFragment());var s=a,o=[];return e.forEach(function(u){if(o.length||u.marks.length){for(var f=0,h=0;f<o.length&&h<u.marks.length;){var l=u.marks[h];if(!t.marks[l.type.name]){h++;continue}if(!l.eq(o[f][0])||l.type.spec.spanning===!1)break;f++,h++}for(;f<o.length;)s=o.pop()[1];for(;h<u.marks.length;){var c=u.marks[h++],v=t.serializeMark(c,u.isInline,r);v&&(o.push([c,s]),s.appendChild(v.dom),s=v.contentDOM||v.dom)}}s.appendChild(t.serializeNodeInner(u,r))}),a}},{key:"serializeNodeInner",value:function(e,t){var r=W(K(t),this.nodes[e.type.name](e),null,e.attrs),a=r.dom,s=r.contentDOM;if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return a}},{key:"serializeNode",value:function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this.serializeNodeInner(e,t),a=e.marks.length-1;a>=0;a--){var s=this.serializeMark(e.marks[a],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}},{key:"serializeMark",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=this.marks[e.type.name];return a&&W(K(r),a(e,t),null,e.attrs)}}],[{key:"renderSpec",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return W(e,t,r,a)}},{key:"fromSchema",value:function(e){return e.cached.domSerializer||(e.cached.domSerializer=new i(this.nodesFromSchema(e),this.marksFromSchema(e)))}},{key:"nodesFromSchema",value:function(e){var t=Ce(e.nodes);return t.text||(t.text=function(r){return r.text}),t}},{key:"marksFromSchema",value:function(e){return Ce(e.marks)}}]),i}();function Ce(i){var n={};for(var e in i){var t=i[e].spec.toDOM;t&&(n[e]=t)}return n}function K(i){return i.document||window.document}var Ne=new WeakMap;function ft(i){var n=Ne.get(i);return n===void 0&&Ne.set(i,n=ht(i)),n}function ht(i){var n=null;function e(t){if(t&&w(t)=="object")if(Array.isArray(t))if(typeof t[0]=="string")n||(n=[]),n.push(t);else for(var r=0;r<t.length;r++)e(t[r]);else for(var a in t)e(t[a])}return e(i),n}function W(i,n,e,t){if(typeof n=="string")return{dom:i.createTextNode(n)};if(n.nodeType!=null)return{dom:n};if(n.dom&&n.dom.nodeType!=null)return n;var r=n[0],a;if(typeof r!="string")throw new RangeError("Invalid array passed to renderSpec");if(t&&(a=ft(t))&&a.indexOf(n)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");var s=r.indexOf(" ");s>0&&(e=r.slice(0,s),r=r.slice(s+1));var o,u=e?i.createElementNS(e,r):i.createElement(r),f=n[1],h=1;if(f&&w(f)=="object"&&f.nodeType==null&&!Array.isArray(f)){h=2;for(var l in f)if(f[l]!=null){var c=l.indexOf(" ");c>0?u.setAttributeNS(l.slice(0,c),l.slice(c+1),f[l]):u.setAttribute(l,f[l])}}for(var v=h;v<n.length;v++){var p=n[v];if(p===0){if(v<n.length-1||v>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}else{var x=W(i,p,e,t),A=x.dom,_=x.contentDOM;if(u.appendChild(A),_){if(o)throw new RangeError("Multiple content holes");o=_}}}return{dom:u,contentDOM:o}}return k.ContentMatch=C,k.DOMParser=it,k.DOMSerializer=ut,k.Fragment=m,k.Mark=d,k.MarkType=ke,k.Node=E,k.NodeRange=fe,k.NodeType=H,k.ReplaceError=D,k.ResolvedPos=G,k.Schema=tt,k.Slice=T,k}var pt=vt();export{pt as d,vt as r};
