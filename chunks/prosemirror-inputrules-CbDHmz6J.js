import{r as q}from"./prosemirror-state-D-8NX-8X.js";import{b as B}from"./prosemirror-transform-AOGtR5Bz.js";var l={},$;function O(){if($)return l;$=1;function C(s,r,n){return Object.defineProperty(s,"prototype",{writable:!1}),s}function y(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var D=q(),m=B,p=C(function s(r,n){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};y(this,s),this.match=r,this.match=r,this.handler=typeof n=="string"?Q(n):n,this.undoable=u.undoable!==!1,this.inCode=u.inCode||!1});function Q(s){return function(r,n,u,o){var t=s;if(n[1]){var e=n[0].lastIndexOf(n[1]);t+=n[0].slice(e+n[1].length),u+=e;var i=u-o;i>0&&(t=n[0].slice(e-i,e)+t,u=o)}return r.tr.insertText(t,u,o)}}var T=500;function S(s){var r=s.rules,n=new D.Plugin({state:{init:function(){return null},apply:function(o,t){var e=o.getMeta(this);return e||(o.selectionSet||o.docChanged?null:t)}},props:{handleTextInput:function(o,t,e,i){return h(o,t,e,i,r,n)},handleDOMEvents:{compositionend:function(o){setTimeout(function(){var t=o.state.selection.$cursor;t&&h(o,t.pos,t.pos,"",r,n)})}}},isInputRules:!0});return n}function h(s,r,n,u,o,t){if(s.composing)return!1;for(var e=s.state,i=e.doc.resolve(r),f=i.parent.textBetween(Math.max(0,i.parentOffset-T),i.parentOffset,null,"￼")+u,a=0;a<o.length;a++){var c=o[a];if(i.parent.type.spec.code){if(!c.inCode)continue}else if(c.inCode==="only")continue;var v=c.match.exec(f),g=v&&c.handler(e,v,r-(v[0].length-u.length),n);if(g)return c.undoable&&g.setMeta(t,{transform:g,from:r,to:n,text:u}),s.dispatch(g),!0}return!1}var b=function(r,n){for(var u=r.plugins,o=0;o<u.length;o++){var t=u[o],e=void 0;if(t.spec.isInputRules&&(e=t.getState(r))){if(n){for(var i=r.tr,f=e.transform,a=f.steps.length-1;a>=0;a--)i.step(f.steps[a].invert(f.docs[a]));if(e.text){var c=i.doc.resolve(e.from).marks();i.replaceWith(e.from,e.to,r.schema.text(e.text,c))}else i.delete(e.from,e.to);n(i)}return!0}}return!1},k=new p(/--$/,"—"),M=new p(/\.\.\.$/,"…"),R=new p(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“"),x=new p(/"$/,"”"),I=new p(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘"),w=new p(/'$/,"’"),A=[R,x,I,w];function F(s,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,u=arguments.length>3?arguments[3]:void 0;return new p(s,function(o,t,e,i){var f=n instanceof Function?n(t):n,a=o.tr.delete(e,i),c=a.doc.resolve(e),v=c.blockRange(),g=v&&m.findWrapping(v,r,f);if(!g)return null;a.wrap(v,g);var d=a.doc.resolve(e-1).nodeBefore;return d&&d.type==r&&m.canJoin(a.doc,e-1)&&(!u||u(t,d))&&a.join(e-1),a})}function P(s,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return new p(s,function(u,o,t,e){var i=u.doc.resolve(t),f=n instanceof Function?n(o):n;return i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),r)?u.tr.delete(t,e).setBlockType(t,t,r,f):null})}return l.InputRule=p,l.closeDoubleQuote=x,l.closeSingleQuote=w,l.ellipsis=M,l.emDash=k,l.inputRules=S,l.openDoubleQuote=R,l.openSingleQuote=I,l.smartQuotes=A,l.textblockTypeInputRule=P,l.undoInputRule=b,l.wrappingInputRule=F,l}var _=O();export{_ as d,O as r};
