import{r as ie}from"./prosemirror-model-BL7fTrkh.js";import{b as oe}from"./prosemirror-transform-AOGtR5Bz.js";var v={},j;function ae(){if(j)return v;j=1;function M(i){"@babel/helpers - typeof";return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},M(i)}function S(){return typeof Reflect<"u"&&Reflect.get?S=Reflect.get:S=function(r,t,n){var e=G(r,t);if(e){var o=Object.getOwnPropertyDescriptor(e,t);return o.get?o.get.call(arguments.length<3?r:n):o.value}},S.apply(this,arguments)}function G(i,r){for(;!Object.prototype.hasOwnProperty.call(i,r)&&(i=d(i),i!==null););return i}function R(i,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(r&&r.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),r&&J(i,r)}function J(i,r){return J=Object.setPrototypeOf||function(n,e){return n.__proto__=e,n},J(i,r)}function T(i){var r=X();return function(){var n=d(i),e;if(r){var o=d(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return H(this,e)}}function H(i,r){if(r&&(M(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q(i)}function Q(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function X(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function d(i){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(i)}function f(i,r){if(!(i instanceof r))throw new TypeError("Cannot call a class as a function")}function D(i,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function h(i,r,t){return r&&D(i.prototype,r),t&&D(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}Object.defineProperty(v,"__esModule",{value:!0});var y=ie(),E=oe,P=Object.create(null),l=function(){function i(r,t,n){f(this,i),this.$anchor=r,this.$head=t,this.ranges=n||[new B(r.min(t),r.max(t))]}return h(i,[{key:"anchor",get:function(){return this.$anchor.pos}},{key:"head",get:function(){return this.$head.pos}},{key:"from",get:function(){return this.$from.pos}},{key:"to",get:function(){return this.$to.pos}},{key:"$from",get:function(){return this.ranges[0].$from}},{key:"$to",get:function(){return this.ranges[0].$to}},{key:"empty",get:function(){for(var t=this.ranges,n=0;n<t.length;n++)if(t[n].$from.pos!=t[n].$to.pos)return!1;return!0}},{key:"content",value:function(){return this.$from.doc.slice(this.from,this.to,!0)}},{key:"replace",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y.Slice.empty,e=n.content.lastChild,o=null,a=0;a<n.openEnd;a++)o=e,e=e.lastChild;for(var s=t.steps.length,u=this.ranges,c=0;c<u.length;c++){var p=u[c],m=p.$from,g=p.$to,U=t.mapping.slice(s);t.replaceRange(U.map(m.pos),U.map(g.pos),c?y.Slice.empty:n),c==0&&C(t,s,(e?e.isInline:o&&o.isTextblock)?-1:1)}}},{key:"replaceWith",value:function(t,n){for(var e=t.steps.length,o=this.ranges,a=0;a<o.length;a++){var s=o[a],u=s.$from,c=s.$to,p=t.mapping.slice(e),m=p.map(u.pos),g=p.map(c.pos);a?t.deleteRange(m,g):(t.replaceRangeWith(m,g,n),C(t,e,n.isInline?-1:1))}}},{key:"getBookmark",value:function(){return w.between(this.$anchor,this.$head).getBookmark()}}],[{key:"findFrom",value:function(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=t.parent.inlineContent?new w(t):b(t.node(0),t.parent,t.pos,t.index(),n,e);if(o)return o;for(var a=t.depth-1;a>=0;a--){var s=n<0?b(t.node(0),t.node(a),t.before(a+1),t.index(a),n,e):b(t.node(0),t.node(a),t.after(a+1),t.index(a)+1,n,e);if(s)return s}return null}},{key:"near",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this.findFrom(t,n)||this.findFrom(t,-n)||new O(t.node(0))}},{key:"atStart",value:function(t){return b(t,t,0,0,1)||new O(t)}},{key:"atEnd",value:function(t){return b(t,t,t.content.size,t.childCount,-1)||new O(t)}},{key:"fromJSON",value:function(t,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");var e=P[n.type];if(!e)throw new RangeError("No selection type ".concat(n.type," defined"));return e.fromJSON(t,n)}},{key:"jsonID",value:function(t,n){if(t in P)throw new RangeError("Duplicate use of selection JSON ID "+t);return P[t]=n,n.prototype.jsonID=t,n}}]),i}();l.prototype.visible=!0;var B=h(function i(r,t){f(this,i),this.$from=r,this.$to=t}),A=!1;function F(i){!A&&!i.parent.inlineContent&&(A=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+i.parent.type.name+")"))}var w=function(i){R(t,i);var r=T(t);function t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;return f(this,t),F(n),F(e),r.call(this,n,e)}return h(t,[{key:"$cursor",get:function(){return this.$anchor.pos==this.$head.pos?this.$head:null}},{key:"map",value:function(e,o){var a=e.resolve(o.map(this.head));if(!a.parent.inlineContent)return l.near(a);var s=e.resolve(o.map(this.anchor));return new t(s.parent.inlineContent?s:a,a)}},{key:"replace",value:function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y.Slice.empty;if(S(d(t.prototype),"replace",this).call(this,e,o),o==y.Slice.empty){var a=this.$from.marksAcross(this.$to);a&&e.ensureMarks(a)}}},{key:"eq",value:function(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head}},{key:"getBookmark",value:function(){return new q(this.anchor,this.head)}},{key:"toJSON",value:function(){return{type:"text",anchor:this.anchor,head:this.head}}}],[{key:"fromJSON",value:function(e,o){if(typeof o.anchor!="number"||typeof o.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(o.anchor),e.resolve(o.head))}},{key:"create",value:function(e,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,s=e.resolve(o);return new this(s,a==o?s:e.resolve(a))}},{key:"between",value:function(e,o,a){var s=e.pos-o.pos;if((!a||s)&&(a=s>=0?1:-1),!o.parent.inlineContent){var u=l.findFrom(o,a,!0)||l.findFrom(o,-a,!0);if(u)o=u.$head;else return l.near(o,a)}return e.parent.inlineContent||(s==0?e=o:(e=(l.findFrom(e,-a,!0)||l.findFrom(e,a,!0)).$anchor,e.pos<o.pos!=s<0&&(e=o))),new t(e,o)}}]),t}(l);l.jsonID("text",w);var q=function(){function i(r,t){f(this,i),this.anchor=r,this.head=t}return h(i,[{key:"map",value:function(t){return new i(t.map(this.anchor),t.map(this.head))}},{key:"resolve",value:function(t){return w.between(t.resolve(this.anchor),t.resolve(this.head))}}]),i}(),k=function(i){R(t,i);var r=T(t);function t(n){var e;f(this,t);var o=n.nodeAfter,a=n.node(0).resolve(n.pos+o.nodeSize);return e=r.call(this,n,a),e.node=o,e}return h(t,[{key:"map",value:function(e,o){var a=o.mapResult(this.anchor),s=a.deleted,u=a.pos,c=e.resolve(u);return s?l.near(c):new t(c)}},{key:"content",value:function(){return new y.Slice(y.Fragment.from(this.node),0,0)}},{key:"eq",value:function(e){return e instanceof t&&e.anchor==this.anchor}},{key:"toJSON",value:function(){return{type:"node",anchor:this.anchor}}},{key:"getBookmark",value:function(){return new Y(this.anchor)}}],[{key:"fromJSON",value:function(e,o){if(typeof o.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(o.anchor))}},{key:"create",value:function(e,o){return new t(e.resolve(o))}},{key:"isSelectable",value:function(e){return!e.isText&&e.type.spec.selectable!==!1}}]),t}(l);k.prototype.visible=!1,l.jsonID("node",k);var Y=function(){function i(r){f(this,i),this.anchor=r}return h(i,[{key:"map",value:function(t){var n=t.mapResult(this.anchor),e=n.deleted,o=n.pos;return e?new q(o,o):new i(o)}},{key:"resolve",value:function(t){var n=t.resolve(this.anchor),e=n.nodeAfter;return e&&k.isSelectable(e)?new k(n):l.near(n)}}]),i}(),O=function(i){R(t,i);var r=T(t);function t(n){return f(this,t),r.call(this,n.resolve(0),n.resolve(n.content.size))}return h(t,[{key:"replace",value:function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y.Slice.empty;if(o==y.Slice.empty){e.delete(0,e.doc.content.size);var a=l.atStart(e.doc);a.eq(e.selection)||e.setSelection(a)}else S(d(t.prototype),"replace",this).call(this,e,o)}},{key:"toJSON",value:function(){return{type:"all"}}},{key:"map",value:function(e){return new t(e)}},{key:"eq",value:function(e){return e instanceof t}},{key:"getBookmark",value:function(){return Z}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(l);l.jsonID("all",O);var Z={map:function(){return this},resolve:function(r){return new O(r)}};function b(i,r,t,n,e){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(r.inlineContent)return w.create(i,t);for(var a=n-(e>0?0:1);e>0?a<r.childCount:a>=0;a+=e){var s=r.child(a);if(s.isAtom){if(!o&&k.isSelectable(s))return k.create(i,t-(e<0?s.nodeSize:0))}else{var u=b(i,s,t+e,e<0?s.childCount:0,e,o);if(u)return u}t+=s.nodeSize*e}return null}function C(i,r,t){var n=i.steps.length-1;if(!(n<r)){var e=i.steps[n];if(e instanceof E.ReplaceStep||e instanceof E.ReplaceAroundStep){var o=i.mapping.maps[n],a;o.forEach(function(s,u,c,p){a==null&&(a=p)}),i.setSelection(l.near(i.doc.resolve(a),t))}}}var K=1,_=2,$=4,W=function(i){R(t,i);var r=T(t);function t(n){var e;return f(this,t),e=r.call(this,n.doc),e.curSelectionFor=0,e.updated=0,e.meta=Object.create(null),e.time=Date.now(),e.curSelection=n.selection,e.storedMarks=n.storedMarks,e}return h(t,[{key:"selection",get:function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}},{key:"setSelection",value:function(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|K)&~_,this.storedMarks=null,this}},{key:"selectionSet",get:function(){return(this.updated&K)>0}},{key:"setStoredMarks",value:function(e){return this.storedMarks=e,this.updated|=_,this}},{key:"ensureMarks",value:function(e){return y.Mark.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}},{key:"addStoredMark",value:function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}},{key:"removeStoredMark",value:function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}},{key:"storedMarksSet",get:function(){return(this.updated&_)>0}},{key:"addStep",value:function(e,o){S(d(t.prototype),"addStep",this).call(this,e,o),this.updated=this.updated&~_,this.storedMarks=null}},{key:"setTime",value:function(e){return this.time=e,this}},{key:"replaceSelection",value:function(e){return this.selection.replace(this,e),this}},{key:"replaceSelectionWith",value:function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=this.selection;return o&&(e=e.mark(this.storedMarks||(a.empty?a.$from.marks():a.$from.marksAcross(a.$to)||y.Mark.none))),a.replaceWith(this,e),this}},{key:"deleteSelection",value:function(){return this.selection.replace(this),this}},{key:"insertText",value:function(e,o,a){var s=this.doc.type.schema;if(o==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();if(a==null&&(a=o),a=a??o,!e)return this.deleteRange(o,a);var u=this.storedMarks;if(!u){var c=this.doc.resolve(o);u=a==o?c.marks():c.marksAcross(this.doc.resolve(a))}return this.replaceRangeWith(o,a,s.text(e,u)),this.selection.empty||this.setSelection(l.near(this.selection.$to)),this}},{key:"setMeta",value:function(e,o){return this.meta[typeof e=="string"?e:e.key]=o,this}},{key:"getMeta",value:function(e){return this.meta[typeof e=="string"?e:e.key]}},{key:"isGeneric",get:function(){for(var e in this.meta)return!1;return!0}},{key:"scrollIntoView",value:function(){return this.updated|=$,this}},{key:"scrolledIntoView",get:function(){return(this.updated&$)>0}}]),t}(E.Transform);function z(i,r){return!r||!i?i:i.bind(r)}var N=h(function i(r,t,n){f(this,i),this.name=r,this.init=z(t.init,n),this.apply=z(t.apply,n)}),ee=[new N("doc",{init:function(r){return r.doc||r.schema.topNodeType.createAndFill()},apply:function(r){return r.doc}}),new N("selection",{init:function(r,t){return r.selection||l.atStart(t.doc)},apply:function(r){return r.selection}}),new N("storedMarks",{init:function(r){return r.storedMarks||null},apply:function(r,t,n,e){return e.selection.$cursor?r.storedMarks:null}}),new N("scrollToSelection",{init:function(){return 0},apply:function(r,t){return r.scrolledIntoView?t+1:t}})],I=h(function i(r,t){var n=this;f(this,i),this.schema=r,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ee.slice(),t&&t.forEach(function(e){if(n.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");n.plugins.push(e),n.pluginsByKey[e.key]=e,e.spec.state&&n.fields.push(new N(e.key,e.spec.state,e))})}),te=function(){function i(r){f(this,i),this.config=r}return h(i,[{key:"schema",get:function(){return this.config.schema}},{key:"plugins",get:function(){return this.config.plugins}},{key:"apply",value:function(t){return this.applyTransaction(t).state}},{key:"filterTransaction",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,e=0;e<this.config.plugins.length;e++)if(e!=n){var o=this.config.plugins[e];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,t,this))return!1}return!0}},{key:"applyTransaction",value:function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var n=[t],e=this.applyInner(t),o=null;;){for(var a=!1,s=0;s<this.config.plugins.length;s++){var u=this.config.plugins[s];if(u.spec.appendTransaction){var c=o?o[s].n:0,p=o?o[s].state:this,m=c<n.length&&u.spec.appendTransaction.call(u,c?n.slice(c):n,p,e);if(m&&e.filterTransaction(m,s)){if(m.setMeta("appendedTransaction",t),!o){o=[];for(var g=0;g<this.config.plugins.length;g++)o.push(g<s?{state:e,n:n.length}:{state:this,n:0})}n.push(m),e=e.applyInner(m),a=!0}o&&(o[s]={state:e,n:n.length})}}if(!a)return{state:e,transactions:n}}}},{key:"applyInner",value:function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new i(this.config),e=this.config.fields,o=0;o<e.length;o++){var a=e[o];n[a.name]=a.apply(t,this[a.name],this,n)}return n}},{key:"tr",get:function(){return new W(this)}},{key:"reconfigure",value:function(t){for(var n=new I(this.schema,t.plugins),e=n.fields,o=new i(n),a=0;a<e.length;a++){var s=e[a].name;o[s]=this.hasOwnProperty(s)?this[s]:e[a].init(t,o)}return o}},{key:"toJSON",value:function(t){var n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(function(s){return s.toJSON()})),t&&M(t)=="object")for(var e in t){if(e=="doc"||e=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");var o=t[e],a=o.spec.state;a&&a.toJSON&&(n[e]=a.toJSON.call(o,this[o.key]))}return n}}],[{key:"create",value:function(t){for(var n=new I(t.doc?t.doc.type.schema:t.schema,t.plugins),e=new i(n),o=0;o<n.fields.length;o++)e[n.fields[o].name]=n.fields[o].init(t,e);return e}},{key:"fromJSON",value:function(t,n,e){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var o=new I(t.schema,t.plugins),a=new i(o);return o.fields.forEach(function(s){if(s.name=="doc")a.doc=y.Node.fromJSON(t.schema,n.doc);else if(s.name=="selection")a.selection=l.fromJSON(a.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(a.storedMarks=n.storedMarks.map(t.schema.markFromJSON));else{if(e)for(var u in e){var c=e[u],p=c.spec.state;if(c.key==s.name&&p&&p.fromJSON&&Object.prototype.hasOwnProperty.call(n,u)){a[s.name]=p.fromJSON.call(c,t,n[u],a);return}}a[s.name]=s.init(t,a)}}),a}}]),i}();function V(i,r,t){for(var n in i){var e=i[n];e instanceof Function?e=e.bind(r):n=="handleDOMEvents"&&(e=V(e,r,{})),t[n]=e}return t}var ne=function(){function i(r){f(this,i),this.spec=r,this.props={},r.props&&V(r.props,this,this.props),this.key=r.key?r.key.key:L("plugin")}return h(i,[{key:"getState",value:function(t){return t[this.key]}}]),i}(),x=Object.create(null);function L(i){return i in x?i+"$"+ ++x[i]:(x[i]=0,i+"$")}var re=function(){function i(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"key";f(this,i),this.key=L(r)}return h(i,[{key:"get",value:function(t){return t.config.pluginsByKey[this.key]}},{key:"getState",value:function(t){return t[this.key]}}]),i}();return v.AllSelection=O,v.EditorState=te,v.NodeSelection=k,v.Plugin=ne,v.PluginKey=re,v.Selection=l,v.SelectionRange=B,v.TextSelection=w,v.Transaction=W,v}var ce=ae();export{ce as d,ae as r};
